<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Surviving from scratch</title>

  <meta property="description" itemprop="description" content="How to model exponential survival probabilities using maximum likelihood from scratch"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-06-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-06-25"/>
  <meta name="article:author" content="Lukas Gröninger"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Surviving from scratch"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="How to model exponential survival probabilities using maximum likelihood from scratch"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Surviving from scratch"/>
  <meta property="twitter:description" content="How to model exponential survival probabilities using maximum likelihood from scratch"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Estimation of exponential survival probabilities with concomitant information;citation_publication_date=1965;citation_volume=21;citation_doi=10.2307/2528247;citation_author=Polly Feigl;citation_author=Marvin Zelen"/>
  <meta name="citation_reference" content="citation_title=Exponential distribution as a survival model;citation_publication_date=2014;citation_publisher=John Wiley &amp; Sons, Ltd;citation_doi=10.1002/9781118445112.stat06019;citation_author=John P. Klein;citation_author=Per Kragh Andersen;citation_author=Niels Keiding"/>
  <meta name="citation_reference" content="citation_title=Use of concomitant variables and incomplete survival information in the estimation of an exponential survival parameter;citation_publication_date=1966;citation_volume=22;citation_doi=10.2307/2528067;citation_author=Calvin Zippin;citation_author=Peter Armitage"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","preview","date","categories","output","draft","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Surviving from scratch"]},{"type":"character","attributes":{},"value":["How to model exponential survival probabilities using maximum likelihood from scratch \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Lukas Gröninger"]}]}]},{"type":"character","attributes":{},"value":["img/survival_img.jpg"]},{"type":"character","attributes":{},"value":["2022-06-25"]},{"type":"character","attributes":{},"value":["R","survival analysis"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["references.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["img/survival_img.jpg","references.bib","surviving-from-scratch_files/anchor-4.2.2/anchor.min.js","surviving-from-scratch_files/bowser-1.9.3/bowser.min.js","surviving-from-scratch_files/distill-2.2.21/template.v2.js","surviving-from-scratch_files/figure-html5/unnamed-chunk-8-1.png","surviving-from-scratch_files/figure-html5/unnamed-chunk-9-1.png","surviving-from-scratch_files/header-attrs-2.14/header-attrs.js","surviving-from-scratch_files/jquery-3.6.0/jquery-3.6.0.js","surviving-from-scratch_files/jquery-3.6.0/jquery-3.6.0.min.js","surviving-from-scratch_files/jquery-3.6.0/jquery-3.6.0.min.map","surviving-from-scratch_files/kePrint-0.0.1/kePrint.js","surviving-from-scratch_files/lightable-0.0.1/lightable.css","surviving-from-scratch_files/popper-2.6.0/popper.min.js","surviving-from-scratch_files/tippy-6.2.7/tippy-bundle.umd.min.js","surviving-from-scratch_files/tippy-6.2.7/tippy-light-border.css","surviving-from-scratch_files/tippy-6.2.7/tippy.css","surviving-from-scratch_files/tippy-6.2.7/tippy.umd.min.js","surviving-from-scratch_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="surviving-from-scratch_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="surviving-from-scratch_files/kePrint-0.0.1/kePrint.js"></script>
  <link href="surviving-from-scratch_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="surviving-from-scratch_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="surviving-from-scratch_files/popper-2.6.0/popper.min.js"></script>
  <link href="surviving-from-scratch_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="surviving-from-scratch_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="surviving-from-scratch_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="surviving-from-scratch_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="surviving-from-scratch_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="surviving-from-scratch_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="surviving-from-scratch_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Surviving from scratch","description":"How to model exponential survival probabilities using maximum likelihood from scratch","authors":[{"author":"Lukas Gröninger","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-06-25T00:00:00.000+02:00","citationText":"Gröninger, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Surviving from scratch</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">R</div>
<div class="dt-tag">survival analysis</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>How to model exponential survival probabilities using maximum
likelihood from scratch</p></p>
</div>

<div class="d-byline">
  Lukas Gröninger  
  
<br/>2022-06-25
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#summary-of-the-paper">Summary of the paper</a>
<ul>
<li><a href="#the-statistical-model">The statistical model</a></li>
<li><a href="#application-of-the-model">Application of the
model</a></li>
<li><a href="#discussion">Discussion</a></li>
</ul></li>
<li><a href="#reproducing-the-results-of-feigl-zelen">Reproducing the
results of Feigl &amp; Zelen</a></li>
</ul>
</nav>
</div>
<p>This post will be about surviving. To be more specific about
probabilities of surviving up to a time point <span
class="math inline">\(t\)</span>. The field of survival analysis is
quite interesting and although there is a strong connection to the field
of epidemiology and medicine, survival can also stand for a variety of
things like mechanical parts “surviving” up to a certain point or
predicting the point in time up to when housing loans are being paid
back. I was glad to see a new package <a
href="https://censored.tidymodels.org/">{censored}</a> joining the
tidymodels family incorporating different survival engines. Now we will
turn to the beginnings of this field and see what one of the first
regression models for survival data looked like.</p>
<aside>
For further information on survival analysis I can recommend the book by
<span class="citation" data-cites="kleinbaum_survival_2012">Kleinbaum
and Klein (<a href="#ref-kleinbaum_survival_2012"
role="doc-biblioref">2012</a>)</span>.
</aside>
<p>The influential paper of <span class="citation"
data-cites="feigl1965">Feigl and Zelen (<a href="#ref-feigl1965"
role="doc-biblioref">1965</a>)</span> is about the estimation of
exponential survival probabilities with concomitant information. That
means they estimated survival distributions when the survival times are
assumed to follow an exponential distribution where the parameters were
influenced by a covariate. In their work they applied these methods on
data of deceased leukemia patients. I will give a summary of their paper
and afterwards reproduce some of it in R using an alternative model.</p>
<h1 id="summary-of-the-paper">Summary of the paper</h1>
<p>The paper by <span class="citation" data-cites="feigl1965">Feigl and
Zelen (<a href="#ref-feigl1965" role="doc-biblioref">1965</a>)</span>
published in the journal <em>Biometrics</em> deals with a statistical
model for estimating the survival time of cancer patients. In
particular, they studied data from patients with leukaemia. Leukaemia
develops in the cells of the bone marrow and is usually characterised by
a large increase in the number of white blood cells in the blood. During
the course of the disease, there is a constant increase in the
concentration of white blood cells, which indicates its severity. When
it comes to predicting the survival time of patients, information on the
amount of white blood cells as well as other indicators of disease
progression is crucial. In their paper, Feigl and Zelen (1965) discuss a
method for modelling survival times based on an exponential distribution
whose parameters depend on these indicators. It is therefore a
parametric model with the white blood cell count as a covariate. In
addition, the survival curves of two different patient groups are
compared. One group has Auer bodies in their cells and the other group
does not.</p>
<p>To estimate the parameters of the model, they use the maximum
likelihood method. In what follows, I will discuss the statistical model
and its methodology in more detail. I also describe in more detail the
data and their approach, as well as the conclusions the authors draw at
the end. What do their results mean and what alternative models could be
applied in this area?</p>
<h2 id="the-statistical-model">The statistical model</h2>
<p>The objective of the two authors is to predict the probability of
survival at a time <span class="math inline">\(t\)</span> of patients
with leukaemia. The survival time variable follows an exponential
distribution whose parameters depend on variables such as the number of
white blood cells. The probability density function of this survival
time can be represented as follows:</p>
<p><span class="math display">\[
\begin{aligned}
f_i(t) &amp;= \lambda_i \ exp(-\lambda_i t) \; \; for \; \; t \geqslant
0  \\
&amp;= 0 \; \; \; \; \; \; \; \; \; \; \; \; \; \; \; \; \; \; \ \ for
\; \; t &lt; 0
\end{aligned}
\]</span></p>
<p>The parameter <span class="math inline">\(\lambda\)</span> is then
dependent on another variable <span class="math inline">\(x\)</span>
which determines the expected value of the survival time of the patient:
<span class="math inline">\(E(t_i) = \frac{1}{\lambda_i} = a + b
x_i\)</span>.</p>
<p>Thus, the parameter <span
class="math inline">\(\lambda_i^{-1}\)</span> results from the equation
resembling the classical linear regression of <span
class="math inline">\(a + bx_i\)</span>. In order to estimate the two
parameters <span class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span>, the maximum likelihood method is
applied. The likelihood function is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
l(a, b) &amp;= \prod_{i=1}^n f_i(t_i) = \prod_{i=1}^n \lambda_i \
exp(-\lambda_i t)  \\
&amp;= (\prod_{i=1}^n (a + bx_i)^{-1})  (exp - \sum_{i=1}^n t_i(a +
bx_i)^{-1})
\end{aligned}
\]</span></p>
<p>Classically, this function is logarithmised to facilitate its use. To
estimate the two parameters, the partial derivatives <span
class="math inline">\(\frac{\partial L}{\partial a}\)</span> and <span
class="math inline">\(\frac{\partial L}{\partial b}\)</span> are now set
to <span class="math inline">\(0\)</span>. The solution is obtained
using the Taylor series. Here, these two equations are expanded in first
order terms. Then, the two parameters <span class="math inline">\(\hat
a\)</span> and <span class="math inline">\(\hat b\)</span> are
estimated, respecting the constraint that <span
class="math inline">\(\hat a + \hat bx_i &gt; 0\)</span> for all <span
class="math inline">\(x_i\)</span> since the parameter <span
class="math inline">\(\lambda\)</span> can only be positive. Finally,
the estimated parameters are used to calculate the probability of
survival of patient <span class="math inline">\(i\)</span>. It is
presented as follows:</p>
<p><span class="math display">\[
S_i(t) = \int_t^{\infty} f_i(\xi) \, d \xi = exp (- \lambda_i t) = exp \
[-t(a + bx_i)^{-1}]
\]</span></p>
<p>As a quality criterion for their estimation, the authors examined the
expected and estimated number of patient deaths in specific time
intervals <span class="math inline">\(t_i(p)\)</span>. The intervals of
<span class="math inline">\(p\)</span> were chosen as quartile
probabilities <span class="math inline">\(p = (0.25, 0.5,
0.75)\)</span>.</p>
<p><span class="math display">\[
\hat S_i[t_i(p)] = exp \ [-t_i(p)(\hat a + \hat bx_i)^{-1}] = p
\]</span></p>
<p>A <span class="math inline">\(\chi^2\)</span> test (in this case with
2 degrees of freedom) can then be performed to compare the observed and
estimated numbers for the specified intervals.</p>
<h2 id="application-of-the-model">Application of the model</h2>
<p>Now that the theoretical statistical model has been presented, let us
move on to the application. As described earlier, this is uncensored
data on patients who died of leukaemia. The <span
class="math inline">\(33\)</span> patients are divided into two groups
according to the presence (AG Positive, <span class="math inline">\(n =
17\)</span>) or absence (AG Negative, <span class="math inline">\(n =
16\)</span>) of Auer bodies in the cytoplasm of their cells. Auer bodies
or rods are found in about 30% of cases in myeloid leukaemia and may
increase the probability of a complete remission rate <span
class="citation" data-cites="seymour1993">(<a href="#ref-seymour1993"
role="doc-biblioref">Seymour and Estey 1993</a>)</span>. The time to
death of patients is given in weeks. The accompanying variable <span
class="math inline">\(x\)</span> is the white blood cell count (<span
class="math inline">\(wbc\)</span>) at diagnosis. This means that this
variable is considered to be independent of time.</p>
<p>Looking at the data, it appears that patients in the GA positive
group have a lower number of <span class="math inline">\(wbc\)</span>
and a significantly longer survival time on average than patients in the
GA negative group. When estimating the parameters <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span> for each group, the following values
were obtained using the presented method.</p>
<div class="layout-chunk" data-layout="l-body">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-1">Table 1: </span>Maximum Likelihood parameters
</caption>
<thead>
<tr>
<th style="text-align:left;">
Patient Group
</th>
<th style="text-align:right;">
a
</th>
<th style="text-align:right;">
b
</th>
<th style="text-align:right;">
sd a
</th>
<th style="text-align:right;">
sd b
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AG positive
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
-44
</td>
<td style="text-align:right;">
95.5
</td>
<td style="text-align:right;">
20.1
</td>
</tr>
<tr>
<td style="text-align:left;">
AG negative
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
-3
</td>
<td style="text-align:right;">
35.1
</td>
<td style="text-align:right;">
8.2
</td>
</tr>
</tbody>
</table>
</div>
<p>By testing their model, they were able to show that the fit was
adequate. The maximum difference between the observed survival
probabilities and the estimated mean is 12%. The most interesting
finding made by the authors concerns the division between the two
groups. For the first AG positive group, the survival probability
depends very strongly on the variable <span
class="math inline">\(wbc\)</span>. For the second group, there is only
a weak relationship. This relationship is also very well reflected in
the different values of <span class="math inline">\(b\)</span>. The
higher <span class="math inline">\(|b|\)</span> is, the greater the
influence of the variable. The authors’ two-sided test revealed a
significant difference between the parameters of the two groups.</p>
<h2 id="discussion">Discussion</h2>
<p><span class="citation" data-cites="feigl1965">Feigl and Zelen (<a
href="#ref-feigl1965" role="doc-biblioref">1965</a>)</span> were able to
show in their work that they can predict survival time with different
exponential distributions as a function of one or possibly several
variables. They were the first to perform a regression analysis of
exponentially distributed survival times <span class="citation"
data-cites="klein2014">(<a href="#ref-klein2014"
role="doc-biblioref">Klein, Andersen, and Keiding 2014</a>)</span>. This
is a definite improvement over previous methods. However, there were
some aspects that simplified their model. First, they treated the
variable <span class="math inline">\(wbc\)</span> as time independent,
recorded at the beginning of diagnostic analysis. For a more realistic
model, this variable should be considered as time-dependent, as the
number of white blood cells changes during the course of the disease.
Another aspect is the fact that only data from patients who have already
died were analysed. A year later, in the same journal, <span
class="citation" data-cites="zippin1966">Zippin and Armitage (<a
href="#ref-zippin1966" role="doc-biblioref">1966</a>)</span> applied and
extended Feigl and Zelen’s approach to data that had been right
censored.</p>
<p>Through their analysis, Feigl and Zelen were able to identify three
important use cases.</p>
<ul>
<li><p>The comparison of survival curves incorporating different
variables and medical information.</p></li>
<li><p>Predicting survival probabilities of individual patients based on
different variables.</p></li>
<li><p>Evaluation of survival data from clinical trials.</p></li>
</ul>
<p>This last point seems to be the most important. It is a step forward
if more in-depth information on patients can be included in clinical
trials. In this way, the effects of treatments can be seen much more
clearly. At the end of their work, they also show how other formulations
of a model could arise. The first variant is <span
class="math inline">\(E(t_i) = (a + bx_i)^{-1}\)</span>. This has the
advantage that <span class="math inline">\(a\)</span> can be considered
independent and in this case we only test the hypothesis that <span
class="math inline">\(b = 0\)</span>. Another alternative is the
formulation <span class="math inline">\(E(t_i) = ae^{bx_i}\)</span>.
Here it is assumed that the logarithm of the average survival time can
be considered as a linear function of the variable <span
class="math inline">\(x\)</span>. I have used this model to reproduce
the authors’ results.</p>
<p>In conclusion, the authors’ contribution has advanced the field of
survival analysis. Nevertheless, it must be said that the exponential
distribution has found limited use in biomedical applications, as its
lack of aging property is too restrictive for most problems. Here, for
example, the Weibull distribution has clear advantages because it not
only allows a constant hazard rate.</p>
<h1 id="reproducing-the-results-of-feigl-zelen">Reproducing the results
of Feigl &amp; Zelen</h1>
<p>I present here the code and calculations with which the results of
<span class="citation" data-cites="feigl1965">Feigl and Zelen (<a
href="#ref-feigl1965" role="doc-biblioref">1965</a>)</span> have been
reproduced. It is the following alternative model:</p>
<p><span class="math display">\[
\begin{aligned}
E(t_i) &amp;= ae^{bx_i}  \\
&amp;= ae^{bd_i}  \; \; with \; \; d_i = x_i - \overline{x}
\end{aligned}
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Required library</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='fu'>plotutils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotutils/man/set_custom_theme.html'>set_custom_theme</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>26</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In their paper, the authors work with a data sample of leukemia
patients with information about their white blood cell count (<span
class="math inline">\(x\)</span>) and the survival time in weeks (<span
class="math inline">\(t\)</span>) from date of diagnosis. Here we have
<span class="math inline">\(n = 17\)</span> data points of group 1 and
their respective survival times. The number is quite small, but it
serves only as a demonstration.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2300</span>, <span class='fl'>750</span>, <span class='fl'>4300</span>, <span class='fl'>2600</span>, <span class='fl'>6000</span>, <span class='fl'>10500</span>, <span class='fl'>10000</span>, <span class='fl'>17000</span>, <span class='fl'>5400</span>, <span class='fl'>7000</span>, <span class='fl'>9400</span>,
       <span class='fl'>32000</span>, <span class='fl'>35000</span>, <span class='fl'>100000</span>, <span class='fl'>100000</span>, <span class='fl'>52000</span>, <span class='fl'>100000</span><span class='op'>)</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>65</span>, <span class='fl'>165</span>, <span class='fl'>100</span>, <span class='fl'>134</span>, <span class='fl'>16</span>, <span class='fl'>108</span>, <span class='fl'>121</span>, <span class='fl'>4</span>, <span class='fl'>39</span>, <span class='fl'>143</span>, <span class='fl'>56</span>, <span class='fl'>26</span>, <span class='fl'>22</span>, <span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>65</span><span class='op'>)</span>

<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>To obtain parameter estimates the maximum likelihood method is
applied. This method maximizes the joint probability density function
with respect to a certain distribution. It then computes the estimate of
the population parameter value that is the optimal fit to the observed
data. The maximum likelihood here can be written as follows:</p>
<p><span class="math display">\[
L(a, b) = -n \; log \; a - \sum_i \frac{t_ie^{-bd_i}}{a}
\]</span></p>
<p>Now the parameters have to be estimated. First we solve for an
estimate for <span class="math inline">\(\hat b\)</span>. Afterwards we
can use the result to receive an estimate for <span
class="math inline">\(\hat a\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial L}{\partial b} &amp;= 0 = \sum_{i = 1}^n t_id_ie^{- \hat
bd_i} \\
\hat a &amp;= \sum_{i = 1}^n \frac{t_ie^{-\hat bd_i}}{n}
\end{aligned}
\]</span></p>
<p>For the calculation of <span class="math inline">\(\hat b\)</span>,
we’ll use the Newton Raphson method. It is a root-finding algorithm that
can be applied iteratively. The idea is to start with an initial guess,
then to approximate the function by its tangent line, and finally to
compute the x-intercept of this tangent line. <span
class="math inline">\(\hat{b}_k\)</span> is the estimate at the <span
class="math inline">\(k\)</span>th iteration.</p>
<p><span class="math display">\[
\hat{b}_{k + 1} = \hat{b}_k - \phi(\hat{b}_k) / \phi&#39;(\hat{b}_k)
\]</span></p>
<p>In our case the we are interested in the function <span
class="math inline">\(\phi(\hat{b})\)</span> as well as the first
derivative <span class="math inline">\(\phi&#39;(\hat{b})\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\phi(\hat{b}) &amp;= \sum_{i = 1}^n t_id_ie^{-\hat{b}d_i} \\
\phi&#39;(\hat{b}) &amp;= - \sum_{i = 1}^n t_id_i^2 e^{-\hat b d_i}
\end{aligned}
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># We'll calculate the paramters with the Newton-Raphson method</span>
<span class='co'># Phi(b)</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>b</span><span class='op'>)</span> <span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='va'>d</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>

<span class='co'># The first derivative of Phi(b)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>b</span><span class='op'>)</span> <span class='op'>{</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='va'>d</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
</code></pre>
</div>
</div>
<p>A first estimate of <span class="math inline">\(\hat b\)</span> is
obtained as follows.</p>
<p><span class="math display">\[
\hat b_0 = \sum_{i = 1}^n d_i \;log\; t_i \; / \;\sum_{i = 1}^n d_i^2
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Initial value for b</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>eps</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='co'># Iterative Newton-Raphson method</span>
<span class='kw'>while</span><span class='op'>(</span><span class='va'>eps</span> <span class='op'>&gt;</span> <span class='fl'>1e-6</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>b_new</span> <span class='op'>&lt;-</span> <span class='va'>b</span> <span class='op'>-</span> <span class='fu'>f</span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>df</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span>
  <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>b_new</span>
  <span class='va'>eps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'>f</span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>df</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>After that, we can then calculate <span class="math inline">\(\hat
a\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Calculate the estimate for a</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The survival function is then as already described above as
follows:</p>
<p><span class="math display">\[
S(t) = exp(-t \; (ae^{bd})^{-1})
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Survival function</span>
<span class='va'>survie</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>t</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='va'>a</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We are looking at different values for the white blood cell count
variable so that we can compare survival probability curves.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2500</span>, <span class='fl'>5000</span>, <span class='fl'>10000</span>, <span class='fl'>20000</span>, <span class='fl'>35000</span>, <span class='fl'>50000</span>, <span class='fl'>75000</span>, <span class='fl'>100000</span><span class='op'>)</span>
<span class='va'>d_values</span> <span class='op'>&lt;-</span> <span class='va'>x_values</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now we apply our survie function and plot the result.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>s_df_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>d_values</span>, <span class='va'>survie</span><span class='op'>)</span><span class='op'>)</span>,
               wbc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>x_values</span>, each <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>,
               t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>d_values</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> |&gt;  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># Starting values: </span>
                   t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># t = 0 -&gt; s = 1</span>
                   wbc <span class='op'>=</span> <span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ag <span class='op'>=</span> <span class='st'>"AG: positive"</span><span class='op'>)</span>

<span class='co'># Create the plot</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>s_df_1</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>s</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>wbc</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modeling Survival Probability"</span>,
       x <span class='op'>=</span> <span class='st'>"Time (weeks)"</span>,
       y <span class='op'>=</span> <span class='st'>"Probability"</span>,
       colour <span class='op'>=</span> <span class='st'>"Different values of WBC"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_color_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"YlOrRd"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="surviving-from-scratch_files/figure-html5/unnamed-chunk-8-1.png" width="768" /></p>
</div>
<p>Here we can directly see the effect of the white blood cell count
variable on the survival probablity curve for group 1 (AG: positive). To
make it easier to work with now we incorporate these parts into one
function.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Put it in one function</span>
<span class='va'>survie_fun</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>t</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>d</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  
  <span class='co'># Phi(b)</span>
  <span class='va'>f</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>b</span><span class='op'>)</span> <span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='va'>d</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
  
  <span class='co'># The first derivative of Phi(b)</span>
  <span class='va'>df</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>b</span><span class='op'>)</span> <span class='op'>{</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='va'>d</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
  
  <span class='co'># Inital valeur pour b</span>
  <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
  <span class='va'>eps</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  
  <span class='co'># Methode de Newton-Raphson</span>
  <span class='kw'>while</span><span class='op'>(</span><span class='va'>eps</span> <span class='op'>&gt;</span> <span class='fl'>1e-6</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>b_new</span> <span class='op'>&lt;-</span> <span class='va'>b</span> <span class='op'>-</span> <span class='fu'>f</span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>df</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span>
    <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>b_new</span>
    <span class='va'>eps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'>f</span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>df</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'># Calculer l'estimateur de a</span>
  <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>b</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># On regarde les valeurs differents pour la covariate wbc (white blood count)</span>
  <span class='va'>x_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2500</span>, <span class='fl'>5000</span>, <span class='fl'>10000</span>, <span class='fl'>20000</span>, <span class='fl'>35000</span>, <span class='fl'>50000</span>, <span class='fl'>75000</span>, <span class='fl'>100000</span><span class='op'>)</span>
  <span class='va'>d_values</span> <span class='op'>&lt;-</span> <span class='va'>x_values</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span>
  
  <span class='co'># Calculer la survie pour les valeurs differents</span>
  <span class='va'>survie</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>t</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='va'>a</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
  
  <span class='va'>survie_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>d_values</span>, <span class='va'>survie</span><span class='op'>)</span><span class='op'>)</span>,
                   wbc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>x_values</span>, each <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>,
                   t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>d_values</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> |&gt;  
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>s <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span>,
                     t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span>,
                     wbc <span class='op'>=</span> <span class='va'>x_values</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>survie_df</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># The values for Group 2</span>
<span class='va'>x_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4400</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>1500</span>, <span class='fl'>9000</span>, <span class='fl'>5300</span>, <span class='fl'>10000</span>, <span class='fl'>19000</span>, <span class='fl'>27000</span>, <span class='fl'>28000</span>, <span class='fl'>31000</span>,
       <span class='fl'>26000</span>, <span class='fl'>21000</span>, <span class='fl'>79000</span>, <span class='fl'>100000</span>, <span class='fl'>100000</span><span class='op'>)</span>
<span class='va'>t_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>56</span>, <span class='fl'>65</span>, <span class='fl'>17</span>, <span class='fl'>7</span>, <span class='fl'>16</span>, <span class='fl'>22</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>8</span>, <span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>30</span>, <span class='fl'>4</span>, <span class='fl'>43</span><span class='op'>)</span>

<span class='va'>s_df_2</span> <span class='op'>&lt;-</span> <span class='fu'>survie_fun</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x_2</span>, t <span class='op'>=</span> <span class='va'>t_2</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ag <span class='op'>=</span> <span class='st'>"AG: negative"</span><span class='op'>)</span>

<span class='va'>s_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>s_df_1</span>, <span class='va'>s_df_2</span><span class='op'>)</span>

<span class='co'># Plot the comparison</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>s_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>s</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>wbc</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>ag</span>, scales <span class='op'>=</span> <span class='st'>"free_x"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modeling the Survival Probability"</span>,
       subtitle <span class='op'>=</span> <span class='st'>"Influence of Auer Bodies"</span>,
       x <span class='op'>=</span> <span class='st'>"Time (weeks)"</span>,
       y <span class='op'>=</span> <span class='st'>"Probability"</span>,
       colour <span class='op'>=</span> <span class='st'>"Different values of WBC"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_color_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"YlOrRd"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="surviving-from-scratch_files/figure-html5/unnamed-chunk-9-1.png" width="768" /></p>
</div>
<p>We managed to show that, also with this alternative model, for the
group with the presence of Auer bodies (AG: positive) the survival
probability depends very strongly on the variable <span
class="math inline">\(wbc\)</span>. This however is not the case when
looking at the group that do not show Auer bodies (AG: negative).</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-feigl1965" class="csl-entry" role="doc-biblioentry">
Feigl, Polly, and Marvin Zelen. 1965. <span>“Estimation of Exponential
Survival Probabilities with Concomitant Information.”</span>
<em>Biometrics</em> 21 (4): 826. <a
href="https://doi.org/10.2307/2528247">https://doi.org/10.2307/2528247</a>.
</div>
<div id="ref-klein2014" class="csl-entry" role="doc-biblioentry">
Klein, John P., Per Kragh Andersen, and Niels Keiding. 2014.
<span>“Exponential Distribution as a Survival Model.”</span> John Wiley
&amp; Sons, Ltd. <a
href="https://doi.org/10.1002/9781118445112.stat06019">https://doi.org/10.1002/9781118445112.stat06019</a>.
</div>
<div id="ref-kleinbaum_survival_2012" class="csl-entry"
role="doc-biblioentry">
Kleinbaum, David G., and Mitchel Klein. 2012. <em>Survival
<span>Analysis</span>: <span>A</span>
<span>Self</span>-<span>Learning</span> <span>Text</span></em>.
Statistics for <span>Biology</span> and <span>Health</span>. New York,
NY: Springer New York. <a
href="https://doi.org/10.1007/978-1-4419-6646-9">https://doi.org/10.1007/978-1-4419-6646-9</a>.
</div>
<div id="ref-seymour1993" class="csl-entry" role="doc-biblioentry">
Seymour, J. F., and E. H. Estey. 1993. <span>“The Prognostic
Significance of Auer Rods in Myelodysplasia.”</span> <em>British Journal
of Haematology</em> 85 (1): 67–76. <a
href="https://doi.org/10.1111/j.1365-2141.1993.tb08647.x">https://doi.org/10.1111/j.1365-2141.1993.tb08647.x</a>.
</div>
<div id="ref-zippin1966" class="csl-entry" role="doc-biblioentry">
Zippin, Calvin, and Peter Armitage. 1966. <span>“Use of Concomitant
Variables and Incomplete Survival Information in the Estimation of an
Exponential Survival Parameter.”</span> <em>Biometrics</em> 22 (4): 665.
<a
href="https://doi.org/10.2307/2528067">https://doi.org/10.2307/2528067</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
